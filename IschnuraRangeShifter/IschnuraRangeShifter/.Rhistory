b[i]
Nt[j]
Nt<- seq(0,1000,10)
exp(-1*b[i]*Nt[j])
-1*b[i]*Nt[j]
b<- seq(1,100,20)
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i])
}
}
-1*b[i]*Nt[j]
Nt<- seq(0,100,10)
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i])
}
}
exp(-1*b[i]*Nt[j])
warnings()
-1*b[i]*Nt[j]
b[i]
Nt[j]
b<- seq(1,5,1)
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i])
}
}
b<- 1/seq(1,5,1)
b<- 1/seq(500,1,-50)
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i])
}
}
Nt<- seq(0,1000,10)
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i])
}
}
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i], pch=1)
}
}
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i], pch=21)
}
}
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(600,15, legend=(b))
legend(600,15, legend=("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
legend(600,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"))
legend(600,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"), col=cols)
legend(600,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"), col=cols, fill=cols)
legend(600,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"), col=cols,
fill=cols, ncol=5)
legend(500,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"), col=cols,
fill=cols, ncol=5)
legend(200,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"), col=cols,
fill=cols, ncol=5)
legend(200,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"), col=cols,
fill=cols, ncol=5, cex=0.8)
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
# print(paste("fec is ", fec, sep=""))
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(200,15, legend=c("1/500", "1/450", "1/400", "1/350", "1/300", "1/250",
"1/200", "1/150", "1/100", "1/50","1"), col=cols,
fill=cols, ncol=5, cex=0.8)
b<- 1/seq(500,1,-100)
cols<- c("red", "blue", "black", "green", "purple")
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(200,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100", "1"), col=cols,
fill=cols, ncol=5, cex=0.8)
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(200,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100", "1"), col=cols,
fill=cols, ncol=3, cex=0.8)
legend(400,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100", "1"), col=cols,
fill=cols, ncol=3, cex=0.8)
legend(500,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100", "1"), col=cols,
fill=cols, ncol=3, cex=0.8)
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(500,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100", "1"), col=cols,
fill=cols, ncol=3, cex=0.8)
b<- 1/c(seq(500,1,-100),1)
cols<- c("red", "blue", "black", "green", "purple", "orange")
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(500,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100", "1"), col=cols,
fill=cols, ncol=3, cex=0.8)
max_fec*exp(-1*b[i]*Nt[j])
b<- 1/seq(500,1,-100)
b<- 1/seq(500,1,-100)
cols<- c("red", "blue", "black", "green", "purple")
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(500,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100"), col=cols,
fill=cols, ncol=3, cex=0.8)
max_fec=10
Nt<- seq(0,1000,10)
b<- 1/500
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, pch=20)
}
max_fec=10
Nt<- seq(0,1000,10)
b<- 1/500
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
max_fec=10
Nt<- seq(0,1000,10)
b<- 1/seq(500,1,-100)
cols<- c("red", "blue", "black", "green", "purple")
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(500,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100"), col=cols,
fill=cols, ncol=3, cex=0.8)
max_fec=10
Nt<- seq(0,1000,10)
b<- 1/500
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/1000
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/100
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
max_fec=0.94
Nt<- seq(0,10000,100)
b<- 1/1000
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
max_fec=1
Nt<- seq(0,10000,100)
b<- 1/1000
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/500
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/100
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/100
plot(0, xlim=c(0,1000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/500
plot(0, xlim=c(0,1000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
Nt<- seq(600,100000,100)
b<- 1/500
plot(0, xlim=c(0,1000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
plot(0, xlim=c(600,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
Nt<- seq(0,100000,100)
b<- 1/500
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/100
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/10000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/15000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/20000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/50000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/70000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/1000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/70000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
Nt<- seq(0,1000000,1000)
b<- 1/5000
plot(0, xlim=c(0,100000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
plot(0, xlim=c(0,1000000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
Nt<- seq(0,10000,1000)
b<- 1/5000
plot(0, xlim=c(0,1000000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
plot(0, xlim=c(0,10000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
Nt<- seq(0,10000,1000)
b<- 1/5000
plot(0, xlim=c(0,10000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/7000
plot(0, xlim=c(0,10000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/2000
plot(0, xlim=c(0,10000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
Nt<- seq(0,10000,1000)
b<- 1/5000
plot(0, xlim=c(0,10000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/2000
plot(0, xlim=c(0,10000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
b<- 1/6000
plot(0, xlim=c(0,10000), ylim=c(0, 2), type="l", xlab="Nt", ylab="fecundity")
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b*Nt[j])
points(Nt[j], fec, pch=20)
}
max_fec=10
Nt<- seq(0,1000,10)
b<- 1/seq(500,1,-100)
cols<- c("red", "blue", "black", "green", "purple")
plot(0, xlim=c(0,1000), ylim=c(0, 15), type="l", xlab="Nt", ylab="fecundity")
for(i in 1:length(b)){
for(j in 1:length(Nt)){
fec<- max_fec*exp(-1*b[i]*Nt[j])
points(Nt[j], fec, col=cols[i], pch=20)
}
}
legend(500,15, legend=c("1/500", "1/400", "1/300",
"1/200", "1/100"), col=cols,
fill=cols, ncol=3, cex=0.8)
300^2
rnorm(20, 0.075, 0.0075)
n_layers=9 #how many layer files do you have?
min_depth=0 #surface=0, otherwise which minimum depth to plot from
dint=10 #depth interval in metres
res=1500 #resolution in metres
min_x=428430 #this is the minimum x coordinate IN METRES!
min_y=6123500 #this is the minimum y coordinate IN METRES!
nr=245 #number of rows
nc=198 #number of columns
max_y=min_y+(res*nr)
max_x=min_x+(res*nc)
min_x
max_x
min_y
max_y
getwd()
setwd("Ischnura/IschnuraRangeShifter/IschnuraRangeShifter/")
#read in the occurence data
occ<- read.csv("Occurence_Data/Ischnura_elegans_2022_10_26.csv",header=T)
#read in the occurence data
occ<- read.csv("Occurence_data/Ischnura_elegans_2022_10_26.csv",header=T)
#read in the occurence data
occ<- read.csv("Occurrence_data/Ischnura_elegans_2022_10_26.csv",header=T)
View(occ)
sw_occ<- occ[occ$country=="Sweden",]
View(sw_occ)
sites<- read,csv("Occurrence_data/allsites_Ischnura.csv", header=T)
sites<- read.csv("Occurrence_data/allsites_Ischnura.csv", header=T)
View(sites)
sw_sites<- sites[sites$transect=="Sweden",]
View(sw_sites)
dim(sw_sites)
sw_sites[56:66,]
sw_sites[57:66,]
sw_sites$corr_lat<- sw_sites$latitude
sw_sites$corr_lon<- sw_sites$longitude
sw_sites$corr_lat[57:66]<- sw_sites$longitude[57:66]
sw_sites$corr_lon[57:66]<- sw_sites$latitude[57:66]
library(terra)
sw_2013<- sw_sites[sw_sites$year==2013,]
sw_2023<- sw_sites[sw_sites$year==2023,]
library(sp)
df.sp<-sw_sites[,6:7]
View(df.sp)
colnames(df.sp)<- c("Latitude", "Longitude")
df.sp<-sw_sites[,c(7,6)]
colnames(df.sp)<- c("Latitude", "Longitude")
colnames(df.sp)<- c("Longitude","Latitude")
sites_latlon<-sw_sites[,c(7,6)]
df.sp<- SpatialPointsDataFrame(coords=sites_latlon,data=sw_sites,
proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
?SpatialPointsDataFrame
##read in sweden shapefile
sweden<- terra::vect("Shapefiles/se_shp/se.shp")
plot(sweden)
plot(df.sp)
plot(sweden)
plot(df.sp, add=T)
plot(df.sp, col="blue", add=T)
class(df.sp)
df.sp<- terra::vect(sites_latlon, crs=CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
df.sp<- terra::vect(sites_latlon, geom=c("Longitude", "Latitude"), crs=CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
colnames(sites_latlon)<- c("lon","lat")
df.sp<- terra::vect(sites_latlon, crs=CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
df.sp<- terra::vect(sites_latlon, crs="+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0")
plot(sweden)
plot(df.sp, col="blue", add=T)
?spTransform
crs(epsg:3006)
sp_reproj<- df_sp
sp_reproj<- df.sp
crs(sp_reproj)<- "epsg:3006"
View(sp_reproj)
crds(sp_reproj)
sp_reproj<- project(df.sp,"epsg:3006" )
crs(sp_reproj)
?proj4string
crs("epsg:3006")
o <- new("Spatial")
proj4string(o) <- CRS("epsg:3006")
o
sp_reproj<- project(df.sp,"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs" )
crds(sp_reproj)
sites_latlon<-sw_2013[,c(7,6)]
#colnames(sites_latlon)<- c("Longitude","Latitude")
colnames(sites_latlon)<- c("lon","lat")
# df.sp<- SpatialPointsDataFrame(coords=sites_latlon,data=sw_sites,
#                                proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
df.sp<- terra::vect(sites_latlon, crs="+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0")
o <- new("Spatial")
proj4string(o) <- CRS("epsg:3006")
sp_reproj<- project(df.sp,"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs" )
crds(sp_reproj)
?writeVector
writeVector(sp_reproj, "occ_2013.gpkg")
sites_latlon<-sw_2023[,c(7,6)]
#colnames(sites_latlon)<- c("Longitude","Latitude")
colnames(sites_latlon)<- c("lon","lat")
# df.sp<- SpatialPointsDataFrame(coords=sites_latlon,data=sw_sites,
#                                proj4string = CRS("+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"))
df.sp<- terra::vect(sites_latlon, crs="+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0")
o <- new("Spatial")
proj4string(o) <- CRS("epsg:3006")
sp_reproj<- project(df.sp,"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs" )
crds(sp_reproj)
#crds(sp_reproj)
writeVector(sp_reproj, "occ_2023.gpkg")
